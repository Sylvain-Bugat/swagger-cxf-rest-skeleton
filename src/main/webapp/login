<html xmlns:th="" xmlns:tiles="">
	<head>
		<title tiles:fragment="title">Messages : Create</title>
		<script src='lib/jquery-1.8.0.min.js' type='text/javascript'></script>
		
		<script type="text/javascript">
		$(document).ready(function() {
			$('form[name=idLogin]').submit(function(e){
				e.preventDefault();
				$.ajax({
					type: 'POST',
					cache: false,
					url: '/api/user/login',
					data: $(this).serialize(), 
					success: function(msg) {
						var apiTokenField=document.getElementById('apiToken');
						apiTokenField.value=msg.apiToken;

						document.forms["apiTokenForm"].submit();
					}
				});
			});
		});
		</script>
	</head>
	<body>
		<div id="boxContentId">
		</div>
		<div tiles:fragment="content">
			<form name="idLogin" action="/api/user/login">
				<fieldset>
					<legend>Please Login</legend>
					<div th:if="${param.error}" class="alert alert-error">
						Invalid username and password.
					</div>
					<label for="username">Username</label>
					<input type="text" id="username" name="username"/>
					<label for="password">Password</label>
					<input type="password" id="password" name="password"/>
					<div class="form-actions">
						<button type="submit" class="btn">Log in</button>
					</div>
				</fieldset>
			</form>

			<form name="apiTokenForm" action="/" method="post">
				<fieldset>
					<legend>Use/test an existing API token</legend>
					<div th:if="${param.error}" class="alert alert-error">
						Invalid API token.
					</div>
					<label for="apiToken">API token</label>
					<input type="text" id="apiToken" name="apiToken"/>
					<div class="form-actions">
						<button type="submit" class="btn">Log in</button>
					</div>
				</fieldset>
			</form>
		</div>
	</body>
</html>
